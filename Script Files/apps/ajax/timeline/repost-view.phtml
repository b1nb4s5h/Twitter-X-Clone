<?php
require_once("../../../core/vipub_web_core.phtml");

$tweet_id = $_GET["tweet_id"];

$sql = "SELECT p.*, u.*, rep.*
        FROM vipub_repost rep
        JOIN vipub_users u ON rep.repost_user_id = u.id
        JOIN vipub_posts p ON rep.repost_post_id = p.p_id
        WHERE rep.repost_post_id = ? AND p.p_id = ?
        ORDER BY rep.reposted_at DESC";
        $stmt = mysqli_prepare($conn, $sql);
        mysqli_stmt_bind_param($stmt, "ii", $tweet_id, $tweet_id);
        mysqli_stmt_execute($stmt);
        $result = mysqli_stmt_get_result($stmt);
        if ($result) {
        if (mysqli_num_rows($result) > 0) {
            while ($rows = mysqli_fetch_assoc($result)) {
            require("../../../themes/default/apps/timeline/include/page/repost.phtml");
            }
        } 
        else {
            vipub_template("timeline/include/page/not-repost");
        }
    } else {
    die("Error: " . mysqli_error($conn));
}

mysqli_stmt_close($stmt);
mysqli_close($conn);
